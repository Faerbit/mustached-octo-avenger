language: cpp
compiler: gcc

install:
    - echo "yes" | sudo add-apt-repository ppa:kalakris/cmake
    - sudo apt-get -qq update
    - sudo apt-get -qq install cmake
    - sudo apt-get -qq install libglew-dev
    - sudo apt-get -qq install libglm-dev
    - curl -O http://www.libsdl.org/release/SDL2-2.0.3.tar.gz
    - tar -xzf SDL2-2.0.3.tar.gz
    - "(cd SDL2-2.0.3 && ./configure && make && sudo make install)"

script:
    - mkdir -p build
    - cd build
    - cmake -DCMAKE_BUILD_TYPE=Release ..
    - make -j$(($(nproc)+1))

after_success:
    - cd $TRAVIS_BUILD_DIR/build
    - cpack

deploy:
  provider: releases
  api_key:
    secure: aFKHt/UpszjM9mt0FsYhJbUzdYb79lA5R3IRUk0+0ziQWcuC31GM8PA3Yb6EuVu0rKEPnD3fUD6iQFmcl4Aqm4h3n2ppDz9DJ83qDvtiXmMbkksYB1HPcJ1xAHcjz5xspNL6lGWeoPHKqr1OUgpqQVBaRthCz10nlXU8PZ/jEZk=
  file: build/octo-avenger*.tar.gz
  on:
    repo: Faerbit/octo-avenger
